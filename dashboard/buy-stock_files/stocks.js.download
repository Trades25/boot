const stocks = [
  { symbol: 'AAPL', name: 'Apple' },
  { symbol: 'AMZN', name: 'Amazon' },
  { symbol: 'GOOGL', name: 'Google' },
  { symbol: 'MSFT', name: 'Microsoft' },
  { symbol: 'FB', name: 'Facebook' },
  { symbol: 'JPM', name: 'JPMorgan Chase' },
  { symbol: 'V', name: 'Visa' },
  { symbol: 'NVDA', name: 'NVIDIA' },
  { symbol: 'TSLA', name: 'Tesla' },
  { symbol: 'BABA', name: 'Alibaba' },
  { symbol: 'JNJ', name: 'Johnson & Johnson' },
  { symbol: 'BRK.A', name: 'Berkshire Hathaway' },
  { symbol: 'WMT', name: 'Walmart' },
  { symbol: 'MA', name: 'Mastercard' },
  { symbol: 'PG', name: 'Procter & Gamble' },
  { symbol: 'JPM', name: 'JPMorgan Chase' },
  { symbol: 'XOM', name: 'Exxon Mobil' },
  { symbol: 'BAC', name: 'Bank of America' },
  { symbol: 'DIS', name: 'Disney' },
  { symbol: 'HD', name: 'Home Depot' },
  { symbol: 'INTC', name: 'Intel' },
  { symbol: 'CMCSA', name: 'Comcast' },
  { symbol: 'NFLX', name: 'Netflix' },
  { symbol: 'VZ', name: 'Verizon' },
  { symbol: 'ADBE', name: 'Adobe' },
  { symbol: 'KO', name: 'Coca-Cola' },
  { symbol: 'NKE', name: 'Nike' },
  { symbol: 'PYPL', name: 'PayPal' },
  { symbol: 'PEP', name: 'PepsiCo' },
  { symbol: 'MRK', name: 'Merck & Co.' },
  { symbol: 'CSCO', name: 'Cisco' },
  { symbol: 'CRM', name: 'Salesforce' },
  { symbol: 'ABBV', name: 'AbbVie' },
  { symbol: 'ORCL', name: 'Oracle' },
  { symbol: 'PFE', name: 'Pfizer' },
  { symbol: 'UNH', name: 'UnitedHealth Group' },
  { symbol: 'T', name: 'AT&T' },
  { symbol: 'BA', name: 'Boeing' },
  { symbol: 'WFC', name: 'Wells Fargo' },
  { symbol: 'IBM', name: 'IBM' },
  { symbol: 'AMGN', name: 'Amgen' },
  { symbol: 'HON', name: 'Honeywell' },
  { symbol: 'CVX', name: 'Chevron' },
  { symbol: 'CAT', name: 'Caterpillar' },
  { symbol: 'XOM', name: 'Exxon Mobil' },
  { symbol: 'MMM', name: '3M' },
  { symbol: 'GE', name: 'General Electric' },
  { symbol: 'DIS', name: 'Disney' },
  { symbol: 'LMT', name: 'Lockheed Martin' },
  { symbol: 'AXP', name: 'American Express' },
  { symbol: 'AMT', name: 'American Tower' },
  { symbol: 'MO', name: 'Altria' },
  { symbol: 'TMO', name: 'Thermo Fisher Scientific' },
  { symbol: 'AVGO', name: 'Broadcom' },
  { symbol: 'PM', name: 'Philip Morris' },
  { symbol: 'ACN', name: 'Accenture' },
  { symbol: 'TXN', name: 'Texas Instruments' },
  { symbol: 'LRCX', name: 'Lam Research' },
  { symbol: 'DHR', name: 'Danaher' },
  { symbol: 'COST', name: 'Costco' },
  { symbol: 'CVS', name: 'CVS Health' },
  { symbol: 'SBUX', name: 'Starbucks' },
  { symbol: 'MS', name: 'Morgan Stanley' },
  { symbol: 'NEE', name: 'NextEra Energy' },
  { symbol: 'UNP', name: 'Union Pacific' },
  { symbol: 'BDX', name: 'Becton Dickinson' },
  { symbol: 'LIN', name: 'Linde' },
  { symbol: 'TXN', name: 'Texas Instruments' },
  { symbol: 'AMD', name: 'Advanced Micro Devices' },
  { symbol: 'INTU', name: 'Intuit' },
  { symbol: 'LOW', name: 'Lowe\'s' },
  { symbol: 'MDT', name: 'Medtronic' },
  { symbol: 'INTC', name: 'Intel' },
  { symbol: 'PLD', name: 'Prologis' },
  { symbol: 'ZTS', name: 'Zoetis' },
  { symbol: 'CCI', name: 'Crown Castle' },
  { symbol: 'BKNG', name: 'Booking Holdings' },
  { symbol: 'MO', name: 'Altria' },
  { symbol: 'UPS', name: 'United Parcel Service' },
  { symbol: 'ANTM', name: 'Anthem' },
  { symbol: 'BLK', name: 'BlackRock' },
  { symbol: 'SPGI', name: 'S&P Global' },
  { symbol: 'SYK', name: 'Stryker' },
  { symbol: 'C', name: 'Citigroup' },
  { symbol: 'GILD', name: 'Gilead Sciences' },
  { symbol: 'CL', name: 'Colgate-Palmolive' },
  { symbol: 'SO', name: 'Southern Company' },
  { symbol: 'CI', name: 'Cigna' },
  { symbol: 'VRTX', name: 'Vertex Pharmaceuticals' },
  { symbol: 'ADI', name: 'Analog Devices' },
  { symbol: 'USB', name: 'U.S. Bancorp' },
  { symbol: 'ITW', name: 'Illinois Tool Works' },
  { symbol: 'FDX', name: 'FedEx' },
  { symbol: 'AON', name: 'Aon' },
  { symbol: 'TMUS', name: 'T-Mobile' },
  { symbol: 'MMC', name: 'Marsh & McLennan' },
  { symbol: 'ECL', name: 'Ecolab' },
  { symbol: 'ADP', name: 'Automatic Data Processing' },
  { symbol: 'RTX', name: 'Raytheon Technologies' },
  { symbol: 'KMB', name: 'Kimberly-Clark' },
  { symbol: 'BMY', name: 'Bristol-Myers Squibb' },
  { symbol: 'ORLY', name: 'O\'Reilly Automotive' },
  { symbol: 'GPN', name: 'Global Payments' },
  { symbol: 'EQIX', name: 'Equinix' },
  { symbol: 'SCHW', name: 'Charles Schwab' },
  { symbol: 'COF', name: 'Capital One' },
  { symbol: 'SPG', name: 'Simon Property Group' },
  { symbol: 'TEL', name: 'TE Connectivity' },
  { symbol: 'FDX', name: 'FedEx' },
  { symbol: 'ROST', name: 'Ross Stores' },
  { symbol: 'ILMN', name: 'Illumina' },
  { symbol: 'MCD', name: 'McDonald\'s' },
  { symbol: 'CME', name: 'CME Group' },
  { symbol: 'CI', name: 'Cigna' },
  { symbol: 'IQV', name: 'IQVIA Holdings' },
  { symbol: 'AEP', name: 'American Electric Power' },
  { symbol: 'DUK', name: 'Duke Energy' },
  { symbol: 'WM', name: 'Waste Management' },
  { symbol: 'FDX', name: 'FedEx' },
  { symbol: 'CCI', name: 'Crown Castle' },
  { symbol: 'CTSH', name: 'Cognizant Technology Solutions' },
  { symbol: 'ABT', name: 'Abbott Laboratories' },
  { symbol: 'BIIB', name: 'Biogen' },
  { symbol: 'ZM', name: 'Zoom Video Communications' },
  { symbol: 'DE', name: 'Deere & Company' },
  { symbol: 'MET', name: 'MetLife' },
  { symbol: 'APH', name: 'Amphenol' },
  { symbol: 'D', name: 'Dominion Energy' },
  { symbol: 'PSA', name: 'Public Storage' },
  { symbol: 'FIS', name: 'Fidelity National Information Services' },
  { symbol: 'SO', name: 'Southern Company' },
  { symbol: 'LHX', name: 'L3Harris Technologies' },
  { symbol: 'PLD', name: 'Prologis' },
  { symbol: 'NEM', name: 'Newmont Mining' },
  { symbol: 'ICE', name: 'Intercontinental Exchange' },
  { symbol: 'EL', name: 'EstÃ©e Lauder' },
  { symbol: 'GD', name: 'General Dynamics' },
  { symbol: 'MSI', name: 'Motorola Solutions' },
  { symbol: 'ANTM', name: 'Anthem' },
  { symbol: 'COG', name: 'Cabot Oil & Gas' },
  { symbol: 'CNC', name: 'Centene' },
  { symbol: 'EA', name: 'Electronic Arts' },
  { symbol: 'GM', name: 'General Motors' },
  { symbol: 'YUM', name: 'Yum! Brands' },
  { symbol: 'TWTR', name: 'Twitter' },
  { symbol: 'COP', name: 'ConocoPhillips' },
  { symbol: 'SYF', name: 'Synchrony Financial' },
  { symbol: 'PEG', name: 'Public Service Enterprise Group' },
  { symbol: 'APD', name: 'Air Products and Chemicals' },
  { symbol: 'WBA', name: 'Walgreens Boots Alliance' },
  { symbol: 'TSN', name: 'Tyson Foods' },
  { symbol: 'TROW', name: 'T. Rowe Price' },
  { symbol: 'TGT', name: 'Target' },
  { symbol: 'HPQ', name: 'HP' },
  { symbol: 'KR', name: 'Kroger' },
  { symbol: 'AIG', name: 'American International Group' },
  { symbol: 'BSX', name: 'Boston Scientific' },
  { symbol: 'ADM', name: 'Archer-Daniels-Midland' },
  { symbol: 'STZ', name: 'Constellation Brands' },
  { symbol: 'CFG', name: 'Citizens Financial Group' },
  { symbol: 'SYY', name: 'Sysco' },
  { symbol: 'SRE', name: 'Sempra Energy' },
  { symbol: 'AFL', name: 'Aflac' },
  { symbol: 'IT', name: 'Gartner' },
  { symbol: 'EXC', name: 'Exelon' },
  { symbol: 'KR', name: 'Kroger' },
  { symbol: 'RMD', name: 'ResMed' },
  { symbol: 'BAX', name: 'Baxter International' },
  { symbol: 'WEC', name: 'WEC Energy Group' },
  { symbol: 'AZO', name: 'AutoZone' },
  { symbol: 'VRTX', name: 'Vertex Pharmaceuticals' },
  { symbol: 'DHI', name: 'D.R. Horton' },
  { symbol: 'CMI', name: 'Cummins' },
  { symbol: 'LUV', name: 'Southwest Airlines' },
  { symbol: 'PGR', name: 'Progressive' },
  { symbol: 'PPL', name: 'PPL' },
  { symbol: 'CMS', name: 'CMS Energy' },
  { symbol: 'TWLO', name: 'Twilio' },
  { symbol: 'BBY', name: 'Best Buy' },
  { symbol: 'EOG', name: 'EOG Resources' },
  { symbol: 'LUV', name: 'Southwest Airlines' },
  { symbol: 'NLOK', name: 'NortonLifeLock' },
  { symbol: 'WLTW', name: 'Willis Towers Watson' },
  { symbol: 'WMB', name: 'Williams Companies' },
  { symbol: 'TDG', name: 'TransDigm Group' },
  { symbol: 'SJM', name: 'J.M. Smucker' },
  { symbol: 'AME', name: 'AMETEK' },
  { symbol: 'OXY', name: 'Occidental Petroleum' },
  { symbol: 'PKG', name: 'Packaging Corporation of America' },
  { symbol: 'RSG', name: 'Republic Services' },
  { symbol: 'FBHS', name: 'Fortune Brands Home & Security' },
  { symbol: 'WLTW', name: 'Willis Towers Watson' },
  { symbol: 'KEYS', name: 'Keysight Technologies' },
  { symbol: 'DXC', name: 'DXC Technology' },
  { symbol: 'WY', name: 'Weyerhaeuser' },
  { symbol: 'HES', name: 'Hess' },
  { symbol: 'DISCA', name: 'Discovery Communications' },
  { symbol: 'HIG', name: 'Hartford Financial Services' },
  { symbol: 'LEN', name: 'Lennar' },
  { symbol: 'CTVA', name: 'Corteva' },
  { symbol: 'MNST', name: 'Monster Beverage' },
  { symbol: 'HSY', name: 'The Hershey Company' },
  { symbol: 'WAT', name: 'Waters Corporation' },
  { symbol: 'ULTA', name: 'Ulta Beauty' },
  { symbol: 'KHC', name: 'Kraft Heinz' },
  { symbol: 'AEE', name: 'Ameren' },
  { symbol: 'WDC', name: 'Western Digital' },
  { symbol: 'CPRT', name: 'Copart' },
  { symbol: 'J', name: 'Jacobs Engineering Group' },
  { symbol: 'ZBH', name: 'Zimmer Biomet' },
  { symbol: 'KEY', name: 'KeyCorp' },
  { symbol: 'IEX', name: 'IDEX Corporation' },
  { symbol: 'CCL', name: 'Carnival' },
  { symbol: 'IVZ', name: 'Invesco' },
  { symbol: 'MKC', name: 'McCormick & Company' },
  { symbol: 'ANSS', name: 'ANSYS' },
  { symbol: 'AIZ', name: 'Assurant' },
  { symbol: 'WEC', name: 'WEC Energy Group' },
  { symbol: 'MTD', name: 'Mettler-Toledo International' },
  { symbol: 'AES', name: 'AES' },
  { symbol: 'SEE', name: 'Sealed Air' },
  { symbol: 'AIV', name: 'Apartment Investment and Management' },
  { symbol: 'CPB', name: 'Campbell Soup' },
  { symbol: 'MRO', name: 'Marathon Oil' },
  { symbol: 'BKR', name: 'Baker Hughes' },
  { symbol: 'ATO', name: 'Atmos Energy' },
  { symbol: 'KMX', name: 'CarMax' },
  { symbol: 'CPRT', name: 'Copart' },
  { symbol: 'MLM', name: 'Martin Marietta Materials' },
  { symbol: 'AJG', name: 'Arthur J. Gallagher' },
  { symbol: 'JEC', name: 'Jacobs Engineering Group' },
  { symbol: 'FLT', name: 'FleetCor Technologies' },
  { symbol: 'IPG', name: 'Interpublic Group' },
  { symbol: 'FTV', name: 'Fortive' },
  { symbol: 'O', name: 'Realty Income' },
  { symbol: 'WHR', name: 'Whirlpool' },
  { symbol: 'VTR', name: 'Ventas' },
  { symbol: 'WYNN', name: 'Wynn Resorts' },
  { symbol: 'PKG', name: 'Packaging Corporation of America' },
  { symbol: 'LDOS', name: 'Leidos Holdings' },
  { symbol: 'JNPR', name: 'Juniper Networks' },
  { symbol: 'COO', name: 'The Cooper Companies' },
  { symbol: 'ELAN', name: 'Elanco Animal Health' },
  { symbol: 'SIVB', name: 'SVB Financial Group' },
  { symbol: 'COTY', name: 'Coty' },
  { symbol: 'DRE', name: 'Duke Realty' },
  { symbol: 'MHK', name: 'Mohawk Industries' },
  { symbol: 'LKQ', name: 'LKQ Corporation' },
  { symbol: 'NOV', name: 'National Oilwell Varco' },
  { symbol: 'APA', name: 'Apache Corporation' },
  { symbol: 'DXC', name: 'DXC Technology' },
  { symbol: 'QRVO', name: 'Qorvo' },
  { symbol: 'PXD', name: 'Pioneer Natural Resources' },
  { symbol: 'PFG', name: 'Principal Financial Group' },
  { symbol: 'CMA', name: 'Comerica' },
  { symbol: 'AOS', name: 'A.O. Smith' },
  { symbol: 'PNR', name: 'Pentair' },
  { symbol: 'XRX', name: 'Xerox' },
  { symbol: 'ALB', name: 'Albemarle' },
  { symbol: 'TDY', name: 'Teledyne Technologies' },
  { symbol: 'WHR', name: 'Whirlpool' },
  { symbol: 'DRI', name: 'Darden Restaurants' },
  { symbol: 'HST', name: 'Host Hotels & Resorts' },
  { symbol: 'VFC', name: 'VF Corporation' },
  { symbol: 'WAB', name: 'Wabtec' },
  { symbol: 'CNP', name: 'CenterPoint Energy' },
  { symbol: 'OKE', name: 'ONEOK' },
  { symbol: 'COO', name: 'The Cooper Companies' },
  { symbol: 'MCK', name: 'McKesson' },
  { symbol: 'EXPE', name: 'Expedia Group' },
  { symbol: 'DISCK', name: 'Discovery Communications' },
  { symbol: 'VNO', name: 'Vornado Realty Trust' },
  { symbol: 'MGM', name: 'MGM Resorts' },
  { symbol: 'WRB', name: 'W. R. Berkley' },
  { symbol: 'LB', name: 'L Brands' },
  { symbol: 'TAP', name: 'Molson Coors Beverage' },
  { symbol: 'URI', name: 'United Rentals' },
  { symbol: 'WHR', name: 'Whirlpool' },
  { symbol: 'FRT', name: 'Federal Realty Investment Trust' },
  { symbol: 'PVH', name: 'PVH Corp.' },
  { symbol: 'HPE', name: 'Hewlett Packard Enterprise' },
  { symbol: 'WRB', name: 'W. R. Berkley' },
  { symbol: 'ROL', name: 'Rollins' },
  { symbol: 'IP', name: 'International Paper' },
  { symbol: 'HOLX', name: 'Hologic' },
  { symbol: 'RHI', name: 'Robert Half International' },
  { symbol: 'BF-B', name: 'Brown-Forman' },
  { symbol: 'LH', name: 'Laboratory Corporation of America' },
  { symbol: 'NVR', name: 'NVR' },
  { symbol: 'WRK', name: 'WestRock' },
  { symbol: 'CMS', name: 'CMS Energy' },
  { symbol: 'STX', name: 'Seagate Technology' },
  { symbol: 'MOS', name: 'The Mosaic Company' },
  { symbol: 'VFC', name: 'VF Corporation' },
  { symbol: 'ALXN', name: 'Alexion Pharmaceuticals' },
  { symbol: 'AIZ', name: 'Assurant' },
  { symbol: 'BEN', name: 'Franklin Resources' },
  { symbol: 'KEYS', name: 'Keysight Technologies' },
  { symbol: 'HRL', name: 'Hormel Foods' },
  { symbol: 'CNP', name: 'CenterPoint Energy' },
  { symbol: 'TXT', name: 'Textron' },
  { symbol: 'LNT', name: 'Alliant Energy' },
  { symbol: 'MHK', name: 'Mohawk Industries' },
  { symbol: 'DGX', name: 'Quest Diagnostics' },
  { symbol: 'MNST', name: 'Monster Beverage' },
  { symbol: 'HII', name: 'Huntington Ingalls Industries' },
  { symbol: 'FMC', name: 'FMC Corporation' },
  { symbol: 'IPGP', name: 'IPG Photonics' },
  { symbol: 'FTNT', name: 'Fortinet' },
  { symbol: 'QRVO', name: 'Qorvo' },
  { symbol: 'LW', name: 'Lamb Weston Holdings' },
  { symbol: 'PKI', name: 'PerkinElmer' },
  { symbol: 'NLSN', name: 'Nielsen Holdings' },
  { symbol: 'CERN', name: 'Cerner' },
  { symbol: 'DISCK', name: 'Discovery Communications' },
  { symbol: 'TSCO', name: 'Tractor Supply Company' },
  { symbol: 'DRE', name: 'Duke Realty' },
  { symbol: 'JNPR', name: 'Juniper Networks' },
  { symbol: 'JWN', name: 'Nordstrom' },
  { symbol: 'LEN', name: 'Lennar' },
  { symbol: 'ADS', name: 'Alliance Data Systems' },
  { symbol: 'CPB', name: 'Campbell Soup' },
  { symbol: 'BWA', name: 'BorgWarner' },
  { symbol: 'NLSN', name: 'Nielsen Holdings' },
  { symbol: 'LEN', name: 'Lennar' },
  { symbol: 'CAH', name: 'Cardinal Health' },
  { symbol: 'WYNN', name: 'Wynn Resorts' },
  { symbol: 'OKE', name: 'ONEOK' },
  { symbol: 'BWA', name: 'BorgWarner' },
  { symbol: 'HIG', name: 'Hartford Financial Services' },
  { symbol: 'RJF', name: 'Raymond James Financial' },
  { symbol: 'TXT', name: 'Textron' },
  { symbol: 'DVN', name: 'Devon Energy' },
  { symbol: 'LW', name: 'Lamb Weston Holdings' },
  { symbol: 'MOS', name: 'The Mosaic Company' },
  { symbol: 'FTNT', name: 'Fortinet' },
  { symbol: 'O', name: 'Realty Income' },
]
document.addEventListener("DOMContentLoaded", async function () {
  const formattedStocks = await Promise.all(stocks.slice(0, 20).map(async stock => {
    const res = await fetch(
      `https://autocomplete.clearbit.com/v1/companies/suggest?query=${stock.name}`
    );
    const data = (await res.json())[0]
    return {
      name: stock.name,
      img: data?.logo,
    }
  }))
  const elements = document.getElementsByClassName("stock-list")
  let test = `<div class="row">`;
  for (let i = 0; i < formattedStocks.length; i++) {
    test +=
      `<div class="col-6 col-md-4">
        <div class="card stock-card">
          <div class="stock-logo-holder">
            <img class="stock-logo" src=${formattedStocks[i].img} />
            <h4>${formattedStocks[i].name}</h4>
          </div>
          <div class="my-3 ">
            <p class="d-flex justify-content-between"><span class="text-white">ROI:</span> <span class="text-success">15.9%-20.3% daily</span></p>
            <hr>
            <small class="text-white">Liquidity Staking</small>
          </div>
          <a href="/investment/${formattedStocks[i].name}?orgLogo=${formattedStocks[i].img}" class="btn btn-success my-3">Buy now</a>
        </div>
      </div>`
  }
  test += `</div>`;
  elements[0].innerHTML = test

  async function customAppend(currentStocks, targetElement, length, type) {
    const updatedStocks = await Promise.all((type === "append" ? currentStocks.slice(length, length + 20) : currentStocks).map(async stock => {
      const res = await fetch(
        `https://autocomplete.clearbit.com/v1/companies/suggest?query=${stock.name}`
      );
      const data = (await res.json())[0]
      return {
        name: stock.name,
        img: data?.logo,
      }
    }))
    let newList = "";
    for (let i = 0; i < updatedStocks.length; i++) {
      newList +=
        `<div class="col-6 col-md-4">
          <div class="card stock-card">
            <div class="stock-logo-holder">
              <img class="stock-logo" src=${updatedStocks[i].img} />
              <h4>${updatedStocks[i].name}</h4>
            </div>
            <div class="my-3 ">
              <p class="d-flex justify-content-between"><span class="text-white">ROI:</span> <span class="text-success">15.9%-20.3% daily</span></p>
              <hr>
            <small class="text-white">Liquidity Staking</small>
            </div>
            <a href="/investment/${updatedStocks[i].name}?orgLogo=${formattedStocks[i].img}" class="btn btn-success my-3">Buy now</a>
          </div>
        </div>`
    }
    if (type === "append") {
      targetElement.insertAdjacentHTML("beforeend", newList)
    }
    if (type === "replace") {
      targetElement.innerHTML = newList
    }
  }

  document.getElementsByTagName('body')[0].onscroll = async function () {
    const {
      scrollTop,
      scrollHeight,
      clientHeight
    } = document.documentElement;
    const t = document.getElementsByClassName("row")[1]
    const t_lenght = t.childNodes.length
    if (scrollTop + clientHeight >= scrollHeight - 5 && t_lenght < stocks.length) {
      customAppend(stocks, t, t_lenght, 'append')
    }
  }

  document.getElementById("search-form").addEventListener("submit", function (e) {
    e.preventDefault()
    const sample = document.getElementsByClassName("search-input")[0].value
    const t = document.getElementsByClassName("row")[1]
    customAppend(stocks.filter(stock => new RegExp(sample, 'i').test(stock.name)) || [], t, stocks.length, "replace")
  })

  // const myModalEl = document.getElementById('buy-stock-modal')
  // $('#buy-stock-modal').on('shown.bs.modal', function (event) {
  //   let searchParams = new URLSearchParams(window.location.search)
  //   document.getElementById("buyStockModalCenterTitle").innerHTML = searchParams.get("name")
  //   document.getElementById("buyStockModalValue").value = searchParams.get("name")
  //   document.getElementById("buyStockModalImg").value = searchParams.get("img")
  // })
})
